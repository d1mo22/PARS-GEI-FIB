# G-interpreter

This project implements an interpreter for a reduced version of the J programming language, called G. The interpreter is designed to evaluate expressions and functions defined in the G language, using Python, ANTLR, and NumPy.

## Project Structure

The project is organized into the following directories and files:

- **g.g4**: ANTLR grammar that defines the syntax and rules of the G language. Includes definitions for arithmetic expressions, boolean operations, assignments, primitive verbs, adverbs, and advanced patterns (hooks, forks, compositions).

- **g.py**: Entry point of the interpreter. Contains the main logic to read, parse, and evaluate source code written in the G language.

- **visitor.py**: Implements the Visitor pattern to traverse the abstract syntax tree (AST) generated by ANTLR. Includes all the evaluation logic for the G language.

- **tests/**: Contains the test files to verify the interpreter's functionality:
  - **test0.j**: Basic arithmetic and precedence tests
  - **test1.j**: Operations with vectors, assignments, and basic verbs
  - **test2.j**: Primitive verbs (comparisons, concatenation, filtering, generation)
  - **test3.j**: Derived functions with adverbs (/, :, ~)
  - **test4.j**: Complex compositions, hooks, and forks
  - **square.j**: Function definitions and advanced patterns
  - **test6.j**: Precedence and parentheses cases
  - **\*.out**: Expected outputs for each test

- **Makefile**: Contains the instructions to compile and execute the project. Defines how to generate the necessary files from the grammar and how to run the tests.

- **run_all_tests.sh**: Alternative bash script to execute and verify all tests with colorized output.

## Features of the G Language

The interpreter supports the following features of the G language:

### Primitive Verbs
- **Arithmetic**: `+`, `-`, `*`, `%` (integer division), `^` (power)
- **Comparison**: `>`, `<`, `>=`, `<=`, `=`, `<>`
- **Special**:
  - `]` (identity)
  - `#` (monadic size / dyadic filtering)
  - `,` (concatenation)
  - `{` (indexing)
  - `|` (modulo/remainder)
  - `i.` (sequence generation)

### Adverbs
- **`/`**: Fold (reduction) - applies a dyadic verb between elements
- **`:`**: Monadic application - converts a dyadic verb into a monadic one
- **`~`**: Flip - swaps arguments of dyadic verbs

### Advanced Patterns
- **Composition (`@:`)**: Function composition f @: g
- **Hook**: Pattern value verb function (e.g., `2 + square`)
- **Fork**: Pattern function verb function (e.g., `(+ ]) * (- ])`)

### System Features
- **Variables**: Assignment with `=:`
- **Vectors**: Native support for multidimensional arrays (NumPy)
- **Precedence**: Right-to-left evaluation
- **Parentheses**: Support for changing precedence
- **Defined functions**: Creation of custom functions

## Usage Instructions

### Prerequisites
```bash
# Install dependencies
pip3 install antlr4-python3-runtime antlr4-tools numpy

```

### Compilation and Execution

1. **Compile the grammar**:
  ```bash
   make
   ```

2. **Execute a specific file**:
   ```bash
   python3 g.py <file.j>
   ```

### Debug Mode

To execute with detailed debug information:
```bash
python3 g.py -d <file.j> 
```

### Cleanup Commands

```bash
make clean      # Clean files generated by ANTLR
```

## Internal Structure

The interpreter uses an architecture based on:

1. **ANTLR Lexer/Parser**: Syntactic analysis of the G code
2. **Visitor Pattern**: Evaluation of the AST using specialized methods
3. **Stack-based Evaluation**: Evaluation of expressions using a stack
4. **NumPy Integration**: Efficient vector operations

## Available Tests

| Test | Description |
|------|-------------|
| test0 | Basic arithmetic and precedence |
| test1 | Vectors, assignments, basic verbs |
| test2 | Complete primitive verbs |
| test3 | Adverbs and derived functions |
| test4 | Compositions and advanced patterns |
| square | Defined functions and complex cases |
| test6 | Precedence and parentheses |

## Useful Makefile Commands

```bash
make help           # Show all available commands
make compile        # Compile ANTLR grammar
make clean          # Clean generated files
```
